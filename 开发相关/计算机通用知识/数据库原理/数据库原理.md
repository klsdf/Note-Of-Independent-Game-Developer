# 名词概念

- 关系：就是表
- 元组、记录：一行的数据，元组是概念层，记录是物理层
- 域：就是属性的取值集合
- 候选码：候选码就是可以区别一个元组（即表中的一行数据）的属性或属性的集合，比如学生表
  student(id,name,age,sex,deptno),其中的id是可以唯一标识一个元组的，所以id是可以作为候选码的，既然id都可以做候选码了，那么id和name这两个属性的组合可不可以唯一区别一个元组呢？显然是可以的，此时的id可以成为码，id和name的组合也可以成为码，但是id和name的组合不能称之为候选码（超码），因为即使去掉name属性，剩下的id属性也完全可以唯一标识一个元组，就是说，候选码中的所有属性都是必须的，缺少了任何一个属性，就不能唯一标识一个元组了，给候选码下一个精确的定义就是：可以唯一标识一个元组的最少的属性集合。 

- 外模式

  用户级数据库

- 概念模式

- 内模式



# 关系代数

## 传统运算

传统的集合运算是二目运算，包括**并、交、差、广义笛卡尔积**四种运算。前面三种都是常识了，稍微说一下笛卡尔积。

假如说有两个表A和B

| A    | B    |
| ---- | ---- |
| a1   | b1   |
| a2   | b2   |
| a3   | b3   |

那么

| A×B = |
| ----- |
| a1b1  |
| a1b2  |
| a1b3  |
| a2b1  |
| a2b2  |
| a2b3  |
| a3b1  |
| a3b2  |
| a3b3  |

也就是说把A中的每一行都和B中的每一行合并一下。最终的行数就是A的行数乘以B的。



## 专门运算

数据库有4中专门的运算符**选择、投影、连接、除**。

为了方便演示，我们不妨建一个表



学生表

| 姓名 | 学号 | 年龄 | 院系 |      |
| ---- | ---- | ---- | ---- | ---- |
| 张三 | 123  | 18   | 计科 |      |
| 李四 | 134  | 19   | 软工 |      |
| 王五 | 145  | 20   | 数媒 |      |



院系





- 选择$\delta$

  选择其实就是选择**行**，比如原表有3行数据，现在只想要其中一部分，那么就可以设一个条件

  > 选择年龄大于18的学生

  那么用代数语言写就是：$\delta_{年龄>18}(学生表) $，意思就是说在学生表中，选择一些行，要求是年龄大于18岁。

  投影运算中间不仅仅可以是大于号，也可以是等于号。比如查询姓名为张三的学生，就是$\delta_{姓名=张三}(学生表)$

- 投影$\Pi$

  **选择是选择行，投影是投影列。**

  但是要注意的是，选择行的时候可以有要求，列的话本身没有什么关系，所以直接指定列名就行了

  > 查询学生的姓名和学号

  $\Pi_{姓名，学号} (学生表)$

- 连接$\bowtie$

  

- 除$÷$

  这个玩意其实很简单，但是书上搞的花里胡哨。

  我们不妨看两个表

  

  学生爱好

  | 学生 | 爱好   |
  | ---- | ------ |
  | 张三 | 足球   |
  | 李四 | 篮球   |
  | 王五 | 足球   |
  | 张三 | 篮球   |
  | 李四 | 羽毛球 |
  | 李四 | 游泳   |
  | 王五 | 羽毛球 |

  爱好表
  
  | 爱好 |
  | ---- |
  | 足球 |
  | 篮球 |
  
  那么学生爱好表÷爱好表是多少？
  
  首先在学生表中筛选，有哪些学生的爱好在爱好表中。
  
  那么很明显，是这么几个人
  
  | 学生 | 爱好 |
  | ---- | ---- |
  | 张三 | 足球 |
  | 李四 | 篮球 |
  | 王五 | 足球 |
  | 张三 | 篮球 |
  
  然后，根据爱好表的内容，划分集合
  
  足球：{张三，王五}
  
  篮球：{张三，李四}
  
  求这两个集合的交集。就是张三了。
  
  除法运算的本质实际上就是计算谁选修了爱好表中**所有**的科目。
  
- 



要注意，如果多个运算复合使用的时候，是先查询，再投影。

> 查找张三同学的学号和年龄

$\Pi_{学号，年龄}(\delta_{姓名=张三}(学生表))$

可以看到，首先先查找了张三同学，之后在进行投影，查找其学号和年龄。







# 范式



# 数据库安全



```sql
#给user1查询学生id的权限，并且允许他把这个权限分发给其他用户
grant select on Student(id) to user1 with grant option
#回收user1的权限，并且收回他给其他人分发的权限
revoke select on Student from user1 cascade
```









# 数据库完整性

## 三大完整性

- 实体完整性：主码唯一，且非空
- 参照完整性：外码要么没有，要么必须是另一个表的主键
- 用户定义完整性（域完整性）：对字段的约束，也就是6大约束。非空约束啦，唯一约束啦什么什么的。

























闫辰祥
